из "lib/каталог.яс" подключить список_товаров как список_товаров_каталога, цена_товара, остаток_товара
из "lib/чек.яс" подключить собрать_чек
из "lib/валидация.яс" подключить код_ошибки_позиции, текст_ошибки, город_поддерживается
из "lib/промо.яс" подключить описание_промо
из "lib/промо.яс" подключить скидка_процент, бесплатная_доставка_по_коду
из "lib/доставка.яс" подключить стоимость_доставки, срок_доставки_дней

экспорт функция здоровье() -> Строка:
    вернуть "ok"

экспорт функция функции_api() -> Список[Строка]:
    вернуть ["здоровье", "список_товаров", "рассчитать_заказ", "ошибка_заказа", "текст_промо"]

экспорт функция список_товаров() -> Список[Словарь[Строка, Строка]]:
    вернуть список_товаров_каталога()

экспорт функция текст_промо(код: Строка) -> Строка:
    вернуть описание_промо(код)

экспорт функция ошибка_заказа(код: Цел) -> Строка:
    вернуть текст_ошибки(код)

экспорт функция рассчитать_заказ(id: Строка, количество: Цел, город: Строка, промо: Строка) -> Словарь[Строка, Цел]:
    пусть цена: Цел = цена_товара(id)
    пусть остаток: Цел = остаток_товара(id)
    пусть код: Цел = код_ошибки_позиции(цена, количество, остаток)
    если не город_поддерживается(город):
        код = 4
    если код != 0:
        вернуть { "ok": 0, "код_ошибки": код, "цена": 0, "количество": количество, "подытог": 0, "скидка_процент": 0, "скидка": 0, "доставка": 0, "срок_дней": 0, "итог": 0 }
    пусть подытог: Цел = цена * количество
    пусть процент: Цел = скидка_процент(промо, подытог)
    пусть бесплатная: Лог = бесплатная_доставка_по_коду(промо)
    пусть доставка: Цел = стоимость_доставки(город, подытог, бесплатная)
    пусть срок_дней: Цел = срок_доставки_дней(город)
    пусть чек: Словарь[Строка, Цел] = собрать_чек(цена, количество, процент, доставка, срок_дней)
    вернуть { "ok": 1, "код_ошибки": 0, "цена": чек["цена"], "количество": чек["количество"], "подытог": чек["подытог"], "скидка_процент": чек["скидка_процент"], "скидка": чек["скидка"], "доставка": чек["доставка"], "срок_дней": чек["срок_дней"], "итог": чек["итог"] }

функция main() -> Пусто:
    пусть пример: Словарь[Строка, Цел] = рассчитать_заказ("coffee", 3, "Москва", "SALE10")
    печать("Сервисы:", функции_api())
    печать("DEMO итог:", пример["итог"])
    вернуть пусто
