# AGENTS.md

## Назначение
Репозиторий `yasniy` — нативный toolchain языка ЯСНЫЙ (`native/yasn-native`, C#/.NET), документация (`docs/`), VS Code extension и UI-пакеты.
Ключевой приоритет: не ломать pipeline компиляции/исполнения и публичные CLI/API-контракты.

## Обязательный workflow через task.md
1. Перед началом любой задачи обязательно создать временный `task.md` в корне проекта.
2. В `task.md` обязательно фиксировать:
   - цель задачи;
   - пошаговый план (чеклист `[ ]/[x]`);
   - рабочий контекст (какие файлы/ограничения важны);
   - текущий этап выполнения (что делается прямо сейчас).
3. После каждого значимого шага обновлять `task.md`: что выполнено, как именно (файлы/команды), что осталось.
4. Перед завершением задачи добавить итог: что сделано и чем подтверждена проверка результата.
5. После закрытия задачи удалить `task.md`, если пользователь явно не попросил сохранить его.

## Критичные правила разработки
- Делать минимальные, целевые изменения; не затрагивать несвязанные файлы.
- Для изменений в `Core/`, `Runtime/`, `Bytecode/` сохранять совместимость полного pipeline:
  `lexer -> parser -> module resolver -> type checker -> compiler -> VM`.
- При изменении CLI-команд или backend-режима (`serve`, `run dev/start`, `/functions`, `/schema`, `/call`) синхронно обновлять документацию в `docs/`.
- Поддерживать UTF-8 и корректную кириллицу в `.яс`, `.md`, `.toml` и примерах.
- Не коммитить временные и сборочные артефакты (`*.ybc`, `*.yapp`, `bin/`, `obj/`, `.yasn/deps/`, `task.md`).

## Минимальная проверка перед сдачей
- `dotnet build native/yasn-native/yasn-native.csproj -c Release`
- `dotnet run --project native/yasn-native/yasn-native.csproj -- test`
- Если затронут backend/UI-контракт: проверить запуск `yasn run dev` и работу `/functions`, `/schema`, `/call`.
